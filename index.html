<!doctype html>
<html>
  <head>
    <title>Getting Started</title>
  </head>
  <body>
      <form>
          <fieldset>
              <label for="fileInput">Select a file</label>
              <input type="file" accept="image/jpeg,audio/wav" id="fileInput" />
          </fieldset>
      </form>
  </body>
  <script type="module">
      import { types, parseFile } from './src/index.js';
      const { CHAR, INT8, INT16, INT32 } = types;

      const jpegHeader = {
          startOfImageMarker: INT16,   // should be 0xffd8
          applicationUseMarker: INT16, // should be 0xffe0
          length: INT16,
          identifier: [ CHAR, 5 ],  // should be "JFIF" with null byte terminator
          version: [ INT8, 2 ],     // first byte major, seocond minor version
          xDensity: INT16,
          yDensity: INT16,
          xThumbnail: INT16,
          yThumbnail: INT16
      };

      const wavHeader = {
          type: [ CHAR, 4 ], // should be "RIFF"
          size: INT32,
          format: [ CHAR, 4 ],
          formatName: [ CHAR, 4 ],
          formatLength: INT32,
          audioFormat: INT16,
          channelAmount: INT16,
          sampleRate: INT32,
          bytesPerSecond: INT32,
          blockAlign: INT16,
          bitsPerSample: INT16,
          dataChunkId: [ CHAR, 4 ],
          dataChunkSize: INT32
      };

      document.querySelector("#fileInput").addEventListener('input', async event => {
          const { files } = event.target;
          const file      = files[ 0 ];

          const header = file.type === 'image/jpeg' ? jpegHeader : wavHeader;
          console.warn( await parseFile( file, header ));
      });

  </script>
</html>
